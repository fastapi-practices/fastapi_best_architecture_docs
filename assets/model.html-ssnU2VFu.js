import{_ as l,c as h,d as a,a as s,b as e,w as t,r as k,o as p}from"./app-BLJpD-6k.js";const r={},d={class:"hint-container warning"};function o(c,i){const n=k("VPLink");return p(),h("div",null,[i[4]||(i[4]=a(`<p>通用模型位于 <code>backend/common/model.py</code> 文件中</p><h2 id="主键" tabindex="-1"><a class="header-anchor" href="#主键"><span>主键</span></a></h2><p>我们未提供自动主键模式，而是必须通过手动定义的方式进行主键声明</p><h3 id="自增-id" tabindex="-1"><a class="header-anchor" href="#自增-id"><span>自增 ID</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-python"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;"># 通用 Mapped 类型主键, 需手动添加，参考以下使用方式</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;"># MappedBase -&gt; id: Mapped[id_key]</span></span>
<span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;"># DataClassBase &amp;&amp; Base -&gt; id: Mapped[id_key] = mapped_column(init=False)</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">id_key </span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;"> Annotated[</span></span>
<span class="line"><span style="--shiki-dark:#56B6C2;--shiki-light:#0184BC;">    int</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">,</span></span>
<span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#383A42;">    mapped_column</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">(</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">        BigInteger,</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">        primary_key</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">True</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">,</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">        unique</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">True</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">,</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">        index</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">True</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">,</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">        autoincrement</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">True</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">,</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">        sort_order</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=-</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">999</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">,</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">        comment</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;主键 ID&#39;</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">,</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">    ),</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="雪花-id" tabindex="-1"><a class="header-anchor" href="#雪花-id"><span>雪花 ID</span></a></h3>`,6)),s("p",null,[e(n,{href:"pk.md",class:"read-more"},{default:t(()=>[...i[0]||(i[0]=[s("strong",null,"切换主键",-1)])]),_:1})]),i[5]||(i[5]=a('<h2 id="mixin-类" tabindex="-1"><a class="header-anchor" href="#mixin-类"><span>Mixin 类</span></a></h2><p><a href="https://en.wikipedia.org/wiki/Mixin" target="_blank" rel="noopener noreferrer">Mixin</a> 是一种面向对象编程概念, 使结构变得更加清晰</p><h3 id="操作人" tabindex="-1"><a class="header-anchor" href="#操作人"><span>操作人</span></a></h3><p>用于集成操作人信息到数据库表</p>',4)),s("div",d,[i[2]||(i[2]=s("p",{class:"hint-container-title"},"注意",-1)),i[3]||(i[3]=s("p",null,"在 fba 中，并没有默认集成操作人员信息到各个数据库表，但是我们提供了非常简易的集成方式",-1)),s("p",null,[e(n,{href:"../../blog/operator.md",class:"read-more"},{default:t(()=>[...i[1]||(i[1]=[s("strong",null,"操作人博客",-1)])]),_:1})])]),i[6]||(i[6]=a(`<h3 id="日期时间" tabindex="-1"><a class="header-anchor" href="#日期时间"><span>日期时间</span></a></h3><p>用于集成日期时间到数据库表，已集成在 <a href="#base-%E5%9F%BA%E7%B1%BB">Base</a> 基类中</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-python"><span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#A626A4;">class</span><span style="--shiki-dark:#E5C07B;--shiki-light:#C18401;"> DateTimeMixin</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#C18401;">(</span><span style="--shiki-dark:#E5C07B;--shiki-light:#C18401;">MappedAsDataclass</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#C18401;">)</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">    &quot;&quot;&quot;日期时间 Mixin 数据类&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">    created_time: Mapped[datetime] </span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#61AFEF;--shiki-light:#383A42;"> mapped_column</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">(</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">        TimeZone, </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">init</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">False</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">default_factory</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">timezone.now, </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">sort_order</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">999</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">comment</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;创建时间&#39;</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">    )</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">    updated_time: Mapped[datetime </span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">|</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;"> None</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">] </span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#61AFEF;--shiki-light:#383A42;"> mapped_column</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">(</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">        TimeZone, </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">init</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">False</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">onupdate</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">timezone.now, </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">sort_order</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;">999</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#E06C75;--shiki-dark-font-style:italic;--shiki-light:#986801;--shiki-light-font-style:inherit;">comment</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;更新时间&#39;</span></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">    )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="数据类基类" tabindex="-1"><a class="header-anchor" href="#数据类基类"><span>数据类基类</span></a></h2><p>声明性数据类基类，它将带有数据类集成，允许使用更高级配置，<mark class="note">但未集成日期时间</mark></p><p>了解 <a href="https://docs.sqlalchemy.org/en/20/orm/dataclasses.html#orm-declarative-native-dataclasses" target="_blank" rel="noopener noreferrer">MappedAsDataclass</a></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-python"><span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#A626A4;">class</span><span style="--shiki-dark:#E5C07B;--shiki-light:#C18401;"> DataClassBase</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#C18401;">(</span><span style="--shiki-dark:#E5C07B;--shiki-light:#C18401;">MappedAsDataclass</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#C18401;">, </span><span style="--shiki-dark:#E5C07B;--shiki-light:#C18401;">MappedBase</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#C18401;">)</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">    __abstract__ </span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;"> True</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="base-基类" tabindex="-1"><a class="header-anchor" href="#base-基类"><span>Base 基类</span></a></h2><p>声明性数据类基类，带有数据类和日期时间集成</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-python"><span class="line"><span style="--shiki-dark:#C678DD;--shiki-light:#A626A4;">class</span><span style="--shiki-dark:#E5C07B;--shiki-light:#C18401;"> Base</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#C18401;">(</span><span style="--shiki-dark:#E5C07B;--shiki-light:#C18401;">DataClassBase</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#C18401;">, </span><span style="--shiki-dark:#E5C07B;--shiki-light:#C18401;">DateTimeMixin</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#C18401;">)</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">    __abstract__ </span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#D19A66;--shiki-light:#986801;"> True</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="字符串类型" tabindex="-1"><a class="header-anchor" href="#字符串类型"><span>字符串类型</span></a></h2><p>对于长文本，fba 提供了内置的 PostgreSQL 和 MySQL 兼容类型 <code>UniversalText</code></p><p>对于常见文本，fba 通常使用以下长度单位：<code>32</code>、<code>64</code>、<code>128</code>、<code>256</code>、<code>512</code></p>`,13))])}const y=l(r,[["render",o]]),B=JSON.parse('{"path":"/backend/reference/model.html","title":"模型","lang":"zh-CN","frontmatter":{"title":"模型","description":"通用模型位于 backend/common/model.py 文件中 主键 我们未提供自动主键模式，而是必须通过手动定义的方式进行主键声明 自增 ID 雪花 ID Mixin 类 Mixin 是一种面向对象编程概念, 使结构变得更加清晰 操作人 用于集成操作人信息到数据库表 注意 在 fba 中，并没有默认集成操作人员信息到各个数据库表，但是我们提供了...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"模型\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://fastapi-practices.github.io/fastapi_best_architecture_docs/fastapi_best_architecture_docs/backend/reference/model.html"}],["meta",{"property":"og:site_name","content":"FastAPI Best Architecture"}],["meta",{"property":"og:title","content":"模型"}],["meta",{"property":"og:description","content":"通用模型位于 backend/common/model.py 文件中 主键 我们未提供自动主键模式，而是必须通过手动定义的方式进行主键声明 自增 ID 雪花 ID Mixin 类 Mixin 是一种面向对象编程概念, 使结构变得更加清晰 操作人 用于集成操作人信息到数据库表 注意 在 fba 中，并没有默认集成操作人员信息到各个数据库表，但是我们提供了..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}]]},"readingTime":{"minutes":1.35,"words":406},"git":{"createdTime":1734951697000},"autoDesc":true,"filePathRelative":"backend/reference/model.md","headers":[],"bulletin":false}');export{y as comp,B as data};
