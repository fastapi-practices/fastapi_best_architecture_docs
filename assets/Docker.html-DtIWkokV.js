import{_ as p,c as o,d as h,a as i,e as t,b as n,w as e,r,o as g}from"./app-BLJpD-6k.js";const c={},A={class:"vp-steps"},y={class:"vp-steps"};function b(F,s){const k=r("Tabs"),d=r("VPLink");return g(),o("div",null,[s[25]||(s[25]=h('<div class="hint-container info"><p class="hint-container-title">相关信息</p><p>一个还不错的教程网站：<a href="https://yeasy.gitbook.io/docker_practice" target="_blank" rel="noopener noreferrer">Docker - 从入门到实践</a></p></div><h2 id="本地部署" tabindex="-1"><a class="header-anchor" href="#本地部署"><span>本地部署</span></a></h2><p>本地部署是为了能够快捷的提供本地 API 服务</p><h3 id="后端" tabindex="-1"><a class="header-anchor" href="#后端"><span>后端</span></a></h3>',4)),i("div",A,[i("ol",null,[s[13]||(s[13]=h('<li><p>env</p><p>在 <code>backend</code> 目录打开终端，创建环境变量文件</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">touch</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> .env</span></span></code></pre></div><p>将初始化环境变量配置拷贝到环境变量文件中</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">cp</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> .env.example</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> .env</span></span></code></pre></div></li><li><p>按需修改配置文件 <code>backend/core/conf.py</code> 和 <code>.env</code></p></li>',2)),i("li",null,[s[4]||(s[4]=i("p",null,"构建容器",-1)),s[5]||(s[5]=i("p",null,"在项目根目录中打开终端，执行以下命令",-1)),s[6]||(s[6]=i("div",{class:"hint-container warning"},[i("p",{class:"hint-container-title"},"注意"),i("p",null,[t("如果容器要在本地启动，需要将 "),i("code",null,".env"),t(" 中的 "),i("code",null,"127.0.0.1"),t(" 更改为 "),i("code",null,"host.docker.internal")])],-1)),n(k,{id:"46",data:[{id:"fba"},{id:"celery"}],"tab-id":"dockerfile"},{title0:e(({value:a,isActive:l})=>[...s[0]||(s[0]=[t("fba",-1)])]),title1:e(({value:a,isActive:l})=>[...s[1]||(s[1]=[t("celery",-1)])]),tab0:e(({value:a,isActive:l})=>[...s[2]||(s[2]=[i("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[i("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[i("code",{class:"language-shell"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," build"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -f"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," Dockerfile"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -t"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_server_independent"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," .")])])])],-1)])]),tab1:e(({value:a,isActive:l})=>[...s[3]||(s[3]=[i("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[i("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[i("code",{class:"language-shell"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," build"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --build-arg"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," SERVER_TYPE=celery"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -t"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_celery_independent"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," .")])])])],-1)])]),_:1})]),i("li",null,[s[11]||(s[11]=i("p",null,"启动容器",-1)),s[12]||(s[12]=i("p",null,"由于构建不包含数据库，请确保本地已安装并启动相关数据库（postgresql / mysql、redis）",-1)),n(k,{id:"62",data:[{id:"fba"},{id:"celery"}],"tab-id":"dockerfile"},{title0:e(({value:a,isActive:l})=>[...s[7]||(s[7]=[t("fba",-1)])]),title1:e(({value:a,isActive:l})=>[...s[8]||(s[8]=[t("celery",-1)])]),tab0:e(({value:a,isActive:l})=>[...s[9]||(s[9]=[i("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[i("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[i("code",{class:"language-shell"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," run"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -d"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -p"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," 8000:8000"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --name"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_server"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_server_independent")])])])],-1)])]),tab1:e(({value:a,isActive:l})=>[...s[10]||(s[10]=[i("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[i("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[i("code",{class:"language-shell"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," run"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -d"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -p"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," 8555:8555"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --name"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_celery"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," fba_celery_independent")])])])],-1)])]),_:1})])])]),s[26]||(s[26]=i("h3",{id:"前端",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#前端"},[i("span",null,"前端")])],-1)),i("p",null,[n(d,{href:"../../frontend/summary/quick-start.md",class:"read-more"},{default:e(()=>[...s[14]||(s[14]=[i("strong",null,"快速开始",-1)])]),_:1})]),s[27]||(s[27]=h('<h2 id="服务器部署" tabindex="-1"><a class="header-anchor" href="#服务器部署"><span>服务器部署</span></a></h2><div class="hint-container warning"><p class="hint-container-title">注意</p><p><mark class="warning">此教程以 HTTPS 为例</mark></p><p>fba 正在使用免费 SSL 证书：<a href="https://httpsok.com/p/4Qjd" target="_blank" rel="noopener noreferrer">httpsok-SSL</a>，证书自动续期，一行命令，轻松搞定 SSL 证书自动续签，支持：nginx、通配符证书、七牛云、腾讯云、阿里云、CDN、OSS、LB（负载均衡）</p></div><h3 id="后端-1" tabindex="-1"><a class="header-anchor" href="#后端-1"><span>后端</span></a></h3>',3)),i("div",y,[i("ol",null,[s[22]||(s[22]=h(`<li><p>拉取代码到服务器</p><p>将代码拉取到服务器通常采用 ssh 方式（更安全），当然你也可以选择使用 HTTPS 方式，具体方式请根据个人自行决定</p></li><li><p>env</p><p>在 <code>backend</code> 目录打开终端，创建环境变量文件</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">touch</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> .env</span></span></code></pre></div><p>进入 <code>deploy/backend/docker-compose</code> 目录，按需修改 <code>.env.server</code> 文件</p><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>我们在 docker-compose 脚本内通过挂载的方式使用 <code>.env.server</code> 文件作为 fba 环境变量文件，因此，本地修改此文件，将同步更新至 docker 容器，这意味着，修改环境变量将无需重新 build</p></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>如果您正在使用 MySQL 数据库，需修改 <code>.env.server</code> 部分配置如下：</p><div class="language-dotenv" data-highlighter="shiki" data-ext="dotenv" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-dotenv"><span class="line"><span style="--shiki-dark:#7F848E;--shiki-dark-font-style:italic;--shiki-light:#A0A1A7;--shiki-light-font-style:italic;"># Database</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_TYPE</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;mysql&#39;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_HOST</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;fba_mysql&#39;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_PORT</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#ABB2BF;--shiki-light:#383A42;">3306</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_USER</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;root&#39;</span></span>
<span class="line"><span style="--shiki-dark:#E06C75;--shiki-light:#E45649;">DATABASE_PASSWORD</span><span style="--shiki-dark:#56B6C2;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;">&#39;123456&#39;</span></span></code></pre></div></div></li><li><p>按需修改配置文件 <code>backend/core/conf.py</code></p></li><li><p>更新 docker-compose 脚本</p><p>脚本 <code>docker-compose.yml</code> 中有相关注释说明，根据需要进行修改即可</p></li>`,4)),i("li",null,[s[19]||(s[19]=i("p",null,"执行一键启动命令",-1)),s[20]||(s[20]=i("p",null,"在项目根目录中打开终端，执行以下命令",-1)),s[21]||(s[21]=i("div",{class:"hint-container warning"},[i("p",{class:"hint-container-title"},"注意"),i("p",null,"命令执行期间遇到镜像拉取问题请自行 Google")],-1)),n(k,{id:"151",data:[{id:"默认端口映射"},{id:"自定义端口映射"}]},{title0:e(({value:a,isActive:l})=>[...s[15]||(s[15]=[t("默认端口映射",-1)])]),title1:e(({value:a,isActive:l})=>[...s[16]||(s[16]=[t("自定义端口映射",-1)])]),tab0:e(({value:a,isActive:l})=>[...s[17]||(s[17]=[i("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[i("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[i("code",{class:"language-shell"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," compose"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," up"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -d"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --build")])])])],-1)])]),tab1:e(({value:a,isActive:l})=>[...s[18]||(s[18]=[i("div",{class:"language-shell","data-highlighter":"shiki","data-ext":"shell",style:{"--shiki-dark":"#abb2bf","--shiki-light":"#383A42","--shiki-dark-bg":"#282c34","--shiki-light-bg":"#FAFAFA"}},[i("pre",{class:"shiki shiki-themes one-dark-pro one-light vp-code"},[i("code",{class:"language-shell"},[i("span",{class:"line"},[i("span",{style:{"--shiki-dark":"#61AFEF","--shiki-light":"#4078F2"}},"docker"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," compose"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --env-file"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," deploy/backend/docker-compose/.env.docker"),i("span",{style:{"--shiki-dark":"#98C379","--shiki-light":"#50A14F"}}," up"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," -d"),i("span",{style:{"--shiki-dark":"#D19A66","--shiki-light":"#986801"}}," --build")])])])],-1)])]),_:1})]),s[23]||(s[23]=i("li",null,[i("p",null,"等待命令执行完成")],-1))])]),s[28]||(s[28]=i("h3",{id:"前端-1",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#前端-1"},[i("span",null,"前端")])],-1)),i("p",null,[n(d,{href:"../../frontend/deploy/docker.md",class:"read-more"},{default:e(()=>[...s[24]||(s[24]=[i("strong",null,"快速开始",-1)])]),_:1})]),s[29]||(s[29]=h('<h2 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span>注意事项</span></a></h2><div class="hint-container warning"><p class="hint-container-title">注意</p><p>不建议频繁使用 <code>docker compose up -d --build</code> 命令，此命令每次执行都会重新构建容器，并将原容器自动本地备份保留，这会导致硬盘空间迅速锐减</p></div><p><a href="https://www.yuque.com/fcant/devops/itkfyytisf9z84y6" class="read-more" target="_blank" rel="noopener noreferrer">15 个 Docker 容器自动化管理的脚本</a></p><p>清理未使用的镜像</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">docker</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> image</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> prune</span></span></code></pre></div><p>清理未使用的容器</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">docker</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> container</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> prune</span></span></code></pre></div><p>清理所有未使用的镜像、容器、网络和构建缓存</p><div class="language-shell" data-highlighter="shiki" data-ext="shell" style="--shiki-dark:#abb2bf;--shiki-light:#383A42;--shiki-dark-bg:#282c34;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes one-dark-pro one-light vp-code"><code class="language-shell"><span class="line"><span style="--shiki-dark:#61AFEF;--shiki-light:#4078F2;">docker</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> system</span><span style="--shiki-dark:#98C379;--shiki-light:#50A14F;"> prune</span></span></code></pre></div>',9))])}const u=p(c,[["render",b]]),f=JSON.parse('{"path":"/backend/deploy/Docker.html","title":"Docker 部署","lang":"zh-CN","frontmatter":{"title":"Docker 部署","description":"相关信息 一个还不错的教程网站：Docker - 从入门到实践 本地部署 本地部署是为了能够快捷的提供本地 API 服务 后端 env 在 backend 目录打开终端，创建环境变量文件 将初始化环境变量配置拷贝到环境变量文件中 按需修改配置文件 backend/core/conf.py 和 .env 构建容器 在项目根目录中打开终端，执行以下命令 注...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Docker 部署\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://fastapi-practices.github.io/fastapi_best_architecture_docs/fastapi_best_architecture_docs/backend/deploy/Docker.html"}],["meta",{"property":"og:site_name","content":"FastAPI Best Architecture"}],["meta",{"property":"og:title","content":"Docker 部署"}],["meta",{"property":"og:description","content":"相关信息 一个还不错的教程网站：Docker - 从入门到实践 本地部署 本地部署是为了能够快捷的提供本地 API 服务 后端 env 在 backend 目录打开终端，创建环境变量文件 将初始化环境变量配置拷贝到环境变量文件中 按需修改配置文件 backend/core/conf.py 和 .env 构建容器 在项目根目录中打开终端，执行以下命令 注..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}]]},"readingTime":{"minutes":2.68,"words":804},"git":{"createdTime":1726501588000},"autoDesc":true,"filePathRelative":"backend/deploy/Docker.md","headers":[],"bulletin":false}');export{u as comp,f as data};
